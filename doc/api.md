# TileService APIs

## Introduction
List of APIs:
- raster: serve only raster tiles
- vector: serve only vector tiles
- rmix: serve raster tiles but will return vector tile when no raster is available
- vmix: serve vector tiles but will return transparent tile when no raster is available at the same coordinates
- rsoucelist: return a list of sources available within a certain boundary at a certain zoom level
- rmosaic: return a custom sized raster image
- utm: same api as legacy utm service
- hmosaic: return a custom sized hybrid image which is generated by overlaying a vector image above a raster image

## Terms
- basicLayer: The most basic layer. The back-end mapnik service only accept a list of such layers and return a composited image of them.
- legendLayer: <name, description, basicLayer list>. It contains multiple basicLayers. Users can check or uncheck a legendLayer to make it shown or hidden.
- legendLayerGroup: <name, legendLayer list>. It groups multiple legendLayers to make the legend panel better organized.

## Commonly used parameters
Parameter   | Value Type | Description
:--------   | :--------- | :----------
server      | String     | 131.94.133.(184/186/188/190)
projection  | String     | which projection is being used
x           | Integer    | x coordinate
y           | Integer    | y coordinate
z           | Integer    | level
source      | string     | optional, filter query by source, case-insensitive. "BEST_AVAILABLE" will be used if this param is missing
date        | string     | optional, filter query by date, in a format like this: 20151007. Tiles from all dates will be used if this param is missing

## ////////////////////////////////// raster API //////////////////////////////////
##### Format
- http://{server}/TileService/raster.aspx?projection=bing&x={x}&y={y}&z={z}&source={source}&date={date}
    - Return: 256*256 raster image under bing projection
- http://{server}/TileService/raster.aspx?projection=bing&x={x}&y={y}&z={z}&checkexistence=1&source={source}&date={date}
    - Return: if raster image is available at that location, return 1, otherwise, return 0.

##### Example
- http://131.94.133.190/TileService/raster.aspx?projection=bing&x=36268&y=55823&z=17

## ////////////////////////////////// vector API //////////////////////////////////
##### Format
- http://{server}/TileService/vector.aspx?projection=bing&styleset={styleset}&x={x}&y={y}&z={z}&layers={basicLayers}
    - Return: 256*256 vector image under bing projection. 

##### Example
- http://131.94.133.184/TileService/vector.aspx?projection=bing&styleset=map&x=0&y=0&z=0&layers=osm_land,osm_landuse
- http://131.94.133.184/TileService/vector.aspx?projection=bing&styleset=map&x=9065&y=13956&z=15&layers=osm_land,osm_landuse,osm_water,osm_buildings,osm_roads,osm_road_names,osm_place_names

##### Parameters
Parameter   | Value Type | Description
:--------   | :--------- | :----------
styleset    | String     | Can be "map" or "hybrid".
basicLayers | String     | Comma seperated list of basicLayers, check excel document for complete list of basicLayers

## ////////////////////////////////// rmix API //////////////////////////////////
##### Format
- http://{server}/TileService/rmix.aspx?projection=bing&x={x}&y={y}&z={z}
    - Return: 256*256 raster or vector image under bing projection, return raster image when raster is available, otherwise, return map-map image (vector image with styleset=map) at the same location.

## ////////////////////////////////// vmix API //////////////////////////////////
##### Format
- http://{server}/TileService/vmix.aspx?projection=bing&styleset={styleset}&x={x}&y={y}&z={z}&layers={basicLayers}
   - Return: 256*256 vector image under bing projection. return normal vector image when raster image is available at the location, otherwise, return fully transparent image.

## ////////////////////////////////// rsoucelist API //////////////////////////////////
##### Format
- http://{server}/TileService/rsoucelist.aspx?projection=bing&z={z}&bbox={bbox}
	- Return: a list of sources in json format: {"success":true, "error_message":"", "sources":[{"name":"BEST_AVAILABLE", "dates":["20150109", "20150709"]}]}

##### Parameters
Parameter   | Value Type | Description
:--------   | :--------- | :----------
bbox        | string     | bounding box. Format: "top,right,bottom,left", top means latitude of top-left corner of the bbox. When top=bottom and left=right, it returns the sources covering that point.

## ////////////////////////////////// rmosaic API (format 1) //////////////////////////////////
##### Format
- http://{server}/TileService/rmosaic.aspx?projection=bing&z={z}&top={top}&left={left}&width={width}&height={height}&source={source}&date={date}
	- Return: a width*height raster mosaic image under bing projection. Note that this API only return images at a certain bing zoom level, but it's faster than the other mosaic API and should always be preferred if zoom level is known.

##### Parameters
Parameter   | Value Type | Description
:--------   | :--------- | :----------
z           | int        | level of requested image
top         | double     | latitude of the topleft corner, in signed degree format, ranging from -90 to 90
left        | double     | longitude of the topleft corner, in signed degree format, ranging from -180 to 180
width       | int        | width of requested image
height      | int        | height of requested image

## ////////////////////////////////// rmosaic API (format 2) //////////////////////////////////
##### Format
- http://{server}/TileService/rmosaic.aspx?projection=bing&width={width}&height={height}&bbox={bbox}&source={source}&date={date}
	- Return: a width*height raster mosaic image under bing projection. Note that this API return images at any resolution

##### Parameters
Parameter   | Value Type | Description
:--------   | :--------- | :----------
bbox        | string     | bounding box. Format: "xmin,ymin,xmax,ymax", in EPSG 3857 coordinate


## ////////////////////////////////// hmosaic API //////////////////////////////////
##### Format
- http://{server}/TileService/hmosaic.aspx?projection=bing&res={res}&top={top}&left={left}&width={width}&height={height}&source={source}&date={date}
	- Return: a width*height raster mosaic image under bing projection. Note that this API return images at any resolution

##### Parameters
Parameter   | Value Type | Description
:--------   | :--------- | :----------
res         | double     | reslution of requested image, unit is meter/pixel
top         | double     | latitude of the topleft corner, in signed degree format, ranging from -90 to 90
left        | double     | longitude of the topleft corner, in signed degree format, ranging from -180 to 180